{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"GeMSE_toolkit \u2014 Handbook (v0.1, draft)","text":"<p>Purpose: This handbook is a practical user guide to simplify daily work with scattered modules within the unified monorepo. First a notebook, then a documentation site. The goal is to quickly transform the information gathered here into a MkDocs Material site.</p>"},{"location":"#0-quick-start-tldr","title":"0. Quick Start (TL;DR)","text":"<pre><code># 1) Clone the repository\ngit clone https://github.com/mucahit-kaya/GeMSE_toolkit\ncd GeMSE_toolkit\n\n# 2) Open the default docker environment (interactive shell)\ndocker pull ramirezdiego/gemse_env:latest\ndocker run -it --rm \\\n  -v \"$PWD\":/work \\\n  -w /work \\\n  ramirezdiego/gemse_env:latest \\\n  /bin/bash\n\n# 3) Typical workflow examples\n</code></pre> <p>More information about docker environment usage is here.</p>"},{"location":"#1-repository-map-and-roles","title":"1. Repository Map and Roles","text":"<pre><code>GeMSE_toolkit/\n\u251c\u2500 docker/                   # Docker &amp; Singularity recipes from GeMSE_environment\n\u251c\u2500 linux/                    # native Linux build scripts\n\u251c\u2500 macos/                    # native macOS build scripts\n\u251c\u2500 common/                   # shared config, schema, logging utils\n\u251c\u2500 cpp/\n\u2502  \u251c\u2500 gemse-analysis/        # C++ analysis code\n\u2502  \u251c\u2500 gemse-mc/              # Geant4-based simulations\n\u2502  \u2514\u2500 gemse-root-scripts/    # ROOT macros / utility tools\n\u251c\u2500 python/\n\u2502  \u2514\u2500 gemsepyana/            # Python analysis package\n\u251c\u2500 jupyter/\n\u2502  \u2514\u2500 gemse-notebooks/       # Experimental notebooks and examples\n\u251c\u2500 docs/                     # MkDocs content\n\u251c\u2500 scripts/                  # CLI helpers for repetitive tasks\n\u251c\u2500 LICENSE\n\u2514\u2500 README.md\n</code></pre> <p>Note: Subtrees were imported with <code>git subtree --squash</code>. Each folder focuses on its own domain; for cross-usage, refer to the playbooks sections in this handbook.</p>"},{"location":"#2-gemse_environment-running-the-analysis-simulation-environment","title":"2. GeMSE_environment : Running the Analysis &amp; Simulation Environment","text":"<p>More detailed instructions are available here.</p>"},{"location":"#21-docker","title":"2.1 Docker","text":"<pre><code># Pull the image\ndocker pull ramirezdiego/gemse_env:latest\n\n# Run container\ndocker run -it --rm \\\n  -v \"$PWD\":/work \\\n  -w /work \\\n  ramirezdiego/gemse_env:latest \\\n  /bin/bash\n</code></pre> <p>For interactive docker usage, see here.</p> <p>Tips</p> <ul> <li>For X11/ROOT graphical windows, XQuartz/Xorg is required on Mac/Linux.</li> <li>Inside the container:</li> </ul> <pre><code># For Analysis tools (ROOT + BAT):\nsource /opt/GeMSE/setup.sh\n\n# For Simulation tools (Geant4):\nsource /opt/GeMSE/geant4_setup.sh\n</code></pre>"},{"location":"#22-apptainersingularity-recommended","title":"2.2 Apptainer/Singularity (Recommended)","text":"<p>Some scripts are especially written for Singularity usage. For regular Linux users, it is recommended to use Singularity/Apptainer instead of Docker. Please refer to here for detailed instructions.</p>"},{"location":"#3-code-building-execution-playbooks","title":"3. Code Building &amp; Execution Playbooks","text":""},{"location":"#31-c-analysis-gemse-analysis","title":"3.1 C++ Analysis (gemse-analysis)","text":"<pre><code>cd cpp/gemse-analysis\ncmake -S . -B build -DCMAKE_BUILD_TYPE=Release\ncmake --build build -j$(nproc)\n./build/bin/&lt;tool-name&gt; --help\n</code></pre> <p>Common Issues</p> <ul> <li><code>libstdc++</code> version conflicts \u2192 Build inside container.</li> <li>ROOT not found \u2192 <code>thisroot.sh</code> not sourced.</li> </ul>"},{"location":"#32-root-scripts-gemse-root-scripts","title":"3.2 ROOT Scripts (gemse-root-scripts)","text":"<pre><code>cd cpp/gemse-root-scripts\nroot -l scripts/energy_resolution.cxx\n# or\nroot -l 'scripts/make_rootfile_spectrum.cxx(\"input.dat\",\"out.root\")'\n</code></pre>"},{"location":"#33-geant4-simulations-gemse-mc","title":"3.3 Geant4 Simulations (gemse-mc)","text":"<pre><code>cd cpp/gemse-mc\ncmake -S . -B build -DGEANT4_USE_OPENGL_X11=ON -DGEANT4_BUILD_MULTITHREADED=ON\ncmake --build build -j\n./build/bin/gemse-mc --help\n</code></pre>"},{"location":"#34-python-analysis-gemsepyana","title":"3.4 Python Analysis (gemsepyana)","text":"<pre><code>cd python/gemsepyana\npip install -e .\npytest -q   # if tests exist\npython -m gemsepyana --help\n</code></pre>"},{"location":"#35-jupyter-notebooks","title":"3.5 Jupyter Notebooks","text":"<pre><code>jupyter lab --notebook-dir=jupyter/gemse-notebooks --ip=0.0.0.0 --allow-root\n</code></pre>"},{"location":"#4-how-to-analyze-a-spectrum","title":"4. How to Analyze a Spectrum:","text":"<p>Follow these steps to analyze a GeMSE spectrum using the integrated tools:</p> <ol> <li> <p>Prepare your data: Ensure your spectrum data is in the correct format (e.g., ROOT file).</p> </li> <li> <p>Load the data: Use the provided Python scripts or Jupyter notebooks to load your spectrum data.</p> </li> <li> <p>Perform analysis: Utilize the analysis functions available in the <code>gemsepyana</code> package to process your spectrum.</p> </li> <li> <p>Visualize results: Generate plots and visualizations to interpret your analysis results.</p> </li> <li> <p>Save outputs: Export your results in the desired format (e.g., figures, tables). For detailed step-by-step instructions, refer to: Analyzing a Spectrum.</p> </li> </ol>"},{"location":"#5-roadmap-notes","title":"5. Roadmap Notes","text":"<ul> <li><code>gemse</code> unified CLI</li> <li>Config schema validation (pydantic/cerberus)</li> <li>Small reference data package and automated smoke tests</li> </ul>"},{"location":"#appendix-pr-checklist","title":"Appendix: PR Checklist","text":"<ul> <li>[ ] Updated README/Handbook steps</li> <li>[ ] Code formatting/lint passed</li> <li>[ ] Tests/smoke tests passed</li> <li>[ ] License headers correct</li> <li>[ ] Changelog updated</li> </ul>"},{"location":"analyze-spectrum/","title":"How to Analyze a Spectrum","text":"<p>This library suitable for analyzing GeMSE spectra provides several integrated tools to facilitate the process. It was built for esspecially GeMSE data that comes from CAEN MCA devices, but can be adapted for other similar spectral data formats.</p>"},{"location":"analyze-spectrum/#measurement-folder-structure","title":"Measurement Folder Structure","text":"<p>The analysis workflow typically involves the following data structure:</p> <pre><code>measurement/\n\u251c\u2500\u2500 .compass/               # Configuration file for Compass data acquisition software, measurement metadata\n\u251c\u2500\u2500 CONFIG                   # Other configuration files for CAEN MCA settings.\n\u2514\u2500\u2500 DAQ/                     # Raw data folders for several runs from CAEN MCA.\n    \u2514\u2500\u2500 run_&lt;number&gt;/       # Individual run folders.\n        \u251c\u2500\u2500 FILTERED         # Filtered spectrum data folder.\n        \u251c\u2500\u2500 RAW              # Raw spectrum data folder.\n            \u251c\u2500\u2500 DataR_CH0@DT5781A_793_run_&lt;number&gt;.root # Raw spectrum file for channel 0\n            \u251c\u2500\u2500 DataR_CH1@DT5781A_793_run_&lt;number&gt;.root # Raw spectrum file for channel 1\n        \u2514\u2500\u2500 UNFILTERED       # Unfiltered spectrum data folder.\n</code></pre> <p>Follow these steps to analyze a GeMSE spectrum using the integrated tools: - Prepare your data: Ensure your spectrum data is in the correct format (e.g., ROOT, CSV, txt file).</p> <pre><code>To better organize your workspace, we recommend placing your data in a folder named `spectra/`. The `init_results_folder.sh` script will automatically create the necessary directory structure to accommodate the measurement that has different runs and store your analysis results.\n</code></pre>"},{"location":"run-environment/","title":"Running the GeMSE Docker Environment","text":"<p>The GeMSE_environment repository provides a fully reproducible software environment for GeMSE analysis and simulations. It includes Miniconda, ROOT, BAT (Bayesian Analysis Toolkit), and Geant4, all pre-installed and configured.</p>"},{"location":"run-environment/#1-using-docker-recommended-for-macos","title":"1. Using Docker (recommended for macOS)","text":"<p>If Docker is available on your machine, you can either build the image locally or pull the prebuilt image from DockerHub.</p> <p>List existing images:</p> <pre><code>docker images\n</code></pre>"},{"location":"run-environment/#a-pull-prebuilt-image-from-dockerhub","title":"A) Pull prebuilt image from DockerHub","text":"<p>A prebuilt version of the container is available at: \u2192 DockerHub</p> <p>You can download it directly:</p> <pre><code>docker pull ramirezdiego/gemse_env:latest\n</code></pre> <p>Once downloaded, start an  container session:</p> <pre><code>docker run -it --rm \\\n  -v \"$PWD\":/work \\\n  -w /work \\\n  ramirezdiego/gemse_env:latest \\\n  /bin/bash\n</code></pre> <p>This command: - runs the GeMSE environment interactively (<code>-it</code>) - removes the container when you exit (<code>--rm</code>) - mounts your current working directory inside the container (<code>-v \"$PWD\":/work</code>) - sets <code>/work</code> as the default working directory (<code>-w /work</code>)</p> <p>You will now be inside the GeMSE analysis environment, ready to use ROOT, Geant4, and BAT.</p> <p>For graphical support, use this command instead:  - For Linux systems: Open X11  access for local Docker containers:</p> <pre><code>xhost +local:docker\n</code></pre> <p>Then run:</p> <pre><code>docker run -it --rm \\\n  --name g4 \\\n  --user $(id -u):$(id -g) \\\n  -e DISPLAY=$DISPLAY \\\n  -v /tmp/.X11-unix:/tmp/.X11-unix \\\n  -v \"$PWD\":/work \\\n  -w /work \\\n  ramirezdiego/gemse_env:latest \\\n  /bin/bash\n\n</code></pre> <p>Alternatively, one can run container as root.</p> <pre><code>docker run -it --rm \\\n  -e DISPLAY=$DISPLAY \\\n  -v /tmp/.X11-unix:/tmp/.X11-unix \\\n  -v \"$PWD\":/work \\\n  -w /work \\\n  ramirezdiego/gemse_env:latest \\\n  /bin/bash\n</code></pre> <ul> <li>For macOS with XQuartz: Make sure \"Allow connections from network clients\" is enabled in XQuartz preferences.</li> </ul> <pre><code>brew install --cask xquartz # if not already installed\nxhost + 127.0.0.1\n</code></pre> <p>Then run:</p> <pre><code>docker run -it --rm \\\n  -e DISPLAY=host.docker.internal:0 \\\n  -v \"$PWD\":/work \\\n  -w /work \\\n  ramirezdiego/gemse_env:latest \\\n  /bin/bash\n</code></pre> <p>Additionally,</p> <pre><code>docker run -it --rm \\\n  --name g4 \\\n  -e DISPLAY=host.docker.internal:0 \\\n  -e LIBGL_ALWAYS_INDIRECT=1 \\\n  -e MESA_GL_VERSION_OVERRIDE=3.3 \\\n  -e MESA_GLSL_VERSION_OVERRIDE=330 \\\n  -v \"$PWD\":/work \\\n  -w /work \\\n  ramirezdiego/gemse_env:latest \\\n  /bin/bash\n\n</code></pre> <ul> <li>now you can use ROOT with graphical support inside the container.</li> </ul> <pre><code>root -l\nroot [0] TBrowser b;\n</code></pre>"},{"location":"run-environment/#b-build-the-image-locally","title":"B) Build the image locally","text":"<p>If you prefer to build it yourself:</p> <pre><code>git clone https://github.com/AG-Schumann/GeMSE_environment.git\ncd GeMSE_environment\ndocker build -t &lt;CONTAINER_NAME&gt; .\n</code></pre> <p>Run the locally built image:</p> <pre><code>docker run -it --rm \\\n  -v \"$PWD\":/work \\\n  -w /work \\\n  &lt;CONTAINER_NAME&gt; \\\n  /bin/bash\n</code></pre> <p>Tip: If you need graphical ROOT (X11) support, add the following flags:</p> <pre><code>-e DISPLAY -v /tmp/.X11-unix:/tmp/.X11-unix\n</code></pre> <p>This enables ROOT's GUI and interactive canvases on your host system.</p>"},{"location":"run-environment/#2-using-singularity-apptainer-for-regular-usage","title":"2. Using Singularity / Apptainer (for regular usage)","text":"<p>Some scripts are especially written for Singularity usage. For regular Linux users, it is recommended to use Singularity/Apptainer instead of Docker.</p>"},{"location":"run-environment/#option-a-build-from-docker-hub","title":"Option A: Build from Docker Hub","text":"<p>If the image is available on DockerHub (e.g. ramirezdiego/gemse_env:latest), run:</p> <pre><code>singularity build --tmpdir ~/Desktop/ gemse_env.sif docker://ramirezdiego/gemse_env:latest\n</code></pre> <p>This command automatically pulls the Docker image from DockerHub and converts it into a Singularity image (<code>.sif</code> file). No manual <code>docker pull</code> is required.</p> <p>The <code>--tmpdir</code> argument specifies a temporary directory with enough free space during the build process.</p> <p>Then, launch an interactive shell:</p> <pre><code>singularity shell gemse_env.sif\n</code></pre>"},{"location":"run-environment/#option-b-build-from-a-local-docker-image","title":"Option B: Build from a local Docker image","text":"<p>If you built the Docker image locally and do not wish to upload it to DockerHub, you can still convert it manually.</p> <p>Method 1 \u2013 Using docker-archive:</p> <pre><code>docker build -t gemse_env:local .\ndocker save gemse_env:local -o gemse_env.tar\nsingularity build gemse_env.sif docker-archive://$(pwd)/gemse_env.tar\n</code></pre> <p>Method 2 \u2013 Using oci-archive (if supported):</p> <pre><code>docker build -t gemse_env:local .\nskopeo copy docker-daemon:gemse_env:local oci-archive:gemse_env_oci.tar:gemse_env_local\nsingularity build gemse_env.sif oci-archive://$(pwd)/gemse_env_oci.tar\n</code></pre> <p>Both methods produce a single, portable <code>gemse_env.sif</code> file equivalent to the Docker image.</p>"},{"location":"run-environment/#3-working-with-the-gemse-environment","title":"3. Working with the GeMSE Environment","text":"<p>Once inside the container (via Docker or Singularity), ROOT, Geant4, and BAT must be set up by sourcing the appropriate scripts:</p> <p>For Analysis tools (ROOT + BAT):</p> <pre><code>source /opt/GeMSE/setup.sh\n</code></pre> <p>For Simulation tools (Geant4):</p> <pre><code>source /opt/GeMSE/geant4_setup.sh\n</code></pre> <p>This configures the environment variables and paths for the installed software.</p>"},{"location":"run-environment/#example-processing-a-gemse-measurement-to-root-file","title":"Example: Processing a GeMSE Measurement to Root File","text":"<pre><code>source /opt/GeMSE/setup.sh\ng++ process_GeMSE_data.cxx -o process_GeMSE_data $(root-config --cflags --libs) -lMinuit\n</code></pre> <p>or </p> <pre><code>g++ ../energy_resolution.cxx -o energy_resolution \\\n    $(root-config --cflags) -O2 -std=c++17 \\\n    $(root-config --libs) -lMinuit\n</code></pre> <p>Then run:</p> <pre><code>./process_GeMSE_data input_data.txt \n</code></pre>"}]}